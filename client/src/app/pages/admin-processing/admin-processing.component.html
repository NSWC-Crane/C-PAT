<!--
!##########################################################################
! CRANE PLAN OF ACTION AND MILESTONE AUTOMATION TOOL (C-PAT) SOFTWARE
! Use is governed by the Open Source Academic Research License Agreement
! contained in the LICENSE.MD file, which is part of this software package.
! BY USING OR MODIFYING THIS SOFTWARE, YOU ARE AGREEING TO THE TERMS AND
! CONDITIONS OF THE LICENSE.
!##########################################################################
-->

<div class="card overflow-hidden relative">
  <p-button icon="pi pi-cog" [rounded]="true" variant="text" (onClick)="navigateToAppInfo()" styleClass="!absolute top-1 right-1 z-10" />
  <p-tabs [(value)]="value" scrollable>
    <p-tablist class="mt-[-1.5rem]">
      <p-tab [value]="0">User Management</p-tab>
      <p-tab [value]="1">Collection Management</p-tab>
      <p-tab [value]="2">STIG Manager</p-tab>
      @if (tenableEnabled) {
        <p-tab [value]="3">Tenable Import</p-tab>
      }
      <p-tab [value]="4">Asset Deltas</p-tab>
      @if (tenableEnabled) {
        <p-tab [value]="5">VRAM IAV Import</p-tab>
      }
      @if (tenableEnabled) {
        <p-tab [value]="6">Nessus Plugin Mapping</p-tab>
      }
      <p-tab [value]="7">A&A Packages</p-tab>
      <p-tab [value]="8">Assigned Teams</p-tab>
      <p-tab [value]="9">App Configuration</p-tab>
    </p-tablist>
    <p-tabpanels>
      <p-tabpanel [value]="0">
        <cpat-user-processing />
      </p-tabpanel>

      <p-tabpanel [value]="1">
        <cpat-collection-processing />
      </p-tabpanel>

      <p-tabpanel [value]="2">
        <cpat-stigmanager-admin />
      </p-tabpanel>

      @if (tenableEnabled) {
        <p-tabpanel [value]="3">
          <cpat-tenable-admin />
        </p-tabpanel>
      }

      <p-tabpanel [value]="4">
        <cpat-asset-delta [activated]="value === 4" />
      </p-tabpanel>

      @if (tenableEnabled) {
        <p-tabpanel [value]="5">
          <cpat-vram-import (navigateToPluginMapping)="switchToPluginMapping()" />
        </p-tabpanel>
      }

      @if (tenableEnabled) {
        <p-tabpanel [value]="6">
          <cpat-nessus-plugin-mapping [activated]="value === 6" />
        </p-tabpanel>
      }

      <p-tabpanel [value]="7">
        <cpat-aa-package-processing />
      </p-tabpanel>

      <p-tabpanel [value]="8">
        <cpat-assigned-team-processing />
      </p-tabpanel>

      <p-tabpanel [value]="9">
        <cpat-app-configuration />
      </p-tabpanel>
    </p-tabpanels>
  </p-tabs>
</div>

<p-toast />
